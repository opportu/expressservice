<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-type" content="text/html" charset="utf-8">
    <title>快递帮——我的发单</title>
    <script src="../js/jquery-3.4.1.min.js"></script>
    <script src="../common/userInfo.js" type="text/javascript"></script>
    <script src="../common/url.js"></script>
    <!-- 新 Bootstrap 核心 CSS 文件 -->
    <link href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">

    <!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
    <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>

    <!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
    <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <style>
        html {
            width: 100%;
            height: 100%;
        }

        body {
            background-color: #CADBE9;
            background-size: cover;
            background-clip: border-box;
            height: 100%;
            width: 100%;
            margin: 0;
            padding: 0;
            font-family: "microsoft yahei";
            min-width: 1200px;
        }

        .myPlacedOrder {
            position: absolute;
            top: 0;
        }

        ul {
            list-style-type: none;
        }

        .myPlacedOrder-nav {
            width: 115px;
            height: 100%;
            position: fixed;
            left: 0;
            border-right: 1px solid black;
            border-bottom: 1px solid black;
            background-color: white;
        }

        .myPlacedOrder-nav table {
            width: 100%;
            text-align: center;
            vertical-align: middle;
            border-collapse: collapse;
        }

        .myPlacedOrder-nav td {
            border: 1px solid #CADBE9;
            height: 60px;
            box-sizing: border-box;

        }

        #processing {
            border-top: 1px solid black;
        }

        .myPlacedOrder-nav td:hover {
            cursor: pointer;
        }

        .myPlacedOrder-content {
            position: relative;
            left: 180px;
            top: 40px;
            width: 1000px;
            height: 100%;
            background-color: #6AAFE6;
            border-radius: 10px;
            padding: 10px 20px;
        }

        span {
            margin: 0 15px;
        }

        .flex-item {
            margin: 2px 0;
            font-size: 15px;
        }

        .receivedOrder-content,
        .processingOrder-content,
        .finishedOrder-content,
        .failedOrder-content {
            position: relative;
            background-color: white;
            padding: 5px 20px;
            display: flex;
            flex-direction: column;
            border-radius: 5px;
            margin-bottom: 4px;
        }

        .receivedOrder-btnDiv {
            position: absolute;
            margin: 2px 0;
            font-size: 15px;
            right: 20px;
            top: 2px;
        }

        .receivedOrder-confirmeBtn,
        .receivedOrder-notBtn {
            margin: 4px 0;
            height: 33px;
            border-radius: 10px;
            background-color: #d6ecfa;
            color: #353866;
        }

        .receivedOrder-deleteBtn,
        .processingOrder-deleteBtn,
        .finishedOrder-deleteBtn,
        .failedOrder-deleteBtn {
            float: right;
            background-color: #d6ecfa;
            height: 27px;
            border-radius: 5px;
            color: #f15c5c;
            margin: 0;
        }

        .receivedOrder-commentBtn,
        .processingOrder-modifyBtn,
        .finishedOrder-commentBtn,
        .failedOrder-commentBtn {
            float: right;
            margin-right: 10px;
            height: 27px;
            border-radius: 5px;
            background-color: #d6ecfa;
            color: #353866;
        }

        .failedOrder-feedbackBtn {
            position: absolute;
            right: 23px;
            top: 10px;
            background-color: #d6ecfa;
            border: 1px dashed #f15c5c;
            color: #353866;
            border-radius: 5px;
        }

        .modal-btn-delete,
        .modal-btn-submit {
            height: 30px;
            border-radius: 5px;
            background-color: #8EC0E4;
            width: 60px;
            letter-spacing: 4px;
        }

        .modal-btn-cancel {
            height: 30px;
            border-radius: 5px;
            background-color: white;
            width: 60px;
            letter-spacing: 4px;
        }

        #modal-feedbackInfo {
            width: 400px;
        }

        button {
            border-style: dashed;
        }
    </style>
</head>

<body>

    <div class="myPlacedOrder">

        <div class="myPlacedOrder-nav">
            <table frame="hsides">
                <tr>
                    <td id="processing" class="myPlacedOrder-nav-orderStatus" onclick="changeContent(this)">未接单</td>
                </tr>
                <tr>
                    <td id="received" class="myPlacedOrder-nav-orderStatus" onclick="changeContent(this)">已接单</td>
                </tr>
                <tr>
                    <td id="finished" class="myPlacedOrder-nav-orderStatus" onclick="changeContent(this)">已完成</td>
                </tr>
                <tr>
                    <td id="failed" class="myPlacedOrder-nav-orderStatus" onclick="changeContent(this)">已失败</td>
                </tr>
            </table>
        </div>

        <div class="myPlacedOrder-content">
            <!-- 未接单模块 -->
            <div class="myPlacedOrder-content-order processingOrder">
                <div class="processingOrder-content" id="10001">
                    <div class="flex-item"><span>1订单时间:2019/12/8</span><span>配送截止时间:2019/12/10
                            14:40</span><span>商品规格：小件</span><span>要求：【不限】</span><span>配送费:5元</span></div>
                    <div class="flex-item"><span>取货地点：西安电子科技大学南校区，综合楼二楼韵达快递</span></div>
                    <div class="flex-item"><span>送货地点：西安电子科技大学南校区，2号宿舍楼509室</span></div>
                    <div class="flex-item"><span>联系方式：15319436400</span></div>
                    <div class="flex-item"><span>备注：取货码18181</span><button class="processingOrder-deleteBtn"
                            data-toggle="modal" data-target="#myModal" onclick="deleteOrder(10001)">删除订单</button><button
                            class="processingOrder-modifyBtn" onclick="">修改号码</button>
                    </div>
                </div>
                <div class="processingOrder-content" id="20001">
                    <div class="flex-item"><span>1订单时间:2019/12/8</span><span>配送截止时间:2019/12/10
                            14:40</span><span>商品规格：小件</span><span>要求：【不限】</span><span>配送费:5元</span></div>
                    <div class="flex-item"><span>取货地点：西安电子科技大学南校区，综合楼二楼韵达快递</span></div>
                    <div class="flex-item"><span>送货地点：西安电子科技大学南校区，2号宿舍楼509室</span></div>
                    <div class="flex-item"><span>联系方式：15319436400</span></div>
                    <div class="flex-item"><span>备注：取货码18181</span><button class="processingOrder-deleteBtn"
                            data-toggle="modal" data-target="#myModal" onclick="deleteOrder(20001)">删除订单</button><button
                            class="processingOrder-modifyBtn" onclick="">修改号码</button>
                    </div>
                </div>
                <div class="processingOrder-content">
                    <div class="flex-item"><span>1订单时间:2019/12/8</span><span>配送截止时间:2019/12/10
                            14:40</span><span>商品规格：小件</span><span>要求：【不限】</span><span>配送费:5元</span></div>
                    <div class="flex-item"><span>取货地点：西安电子科技大学南校区，综合楼二楼韵达快递</span></div>
                    <div class="flex-item"><span>送货地点：西安电子科技大学南校区，2号宿舍楼509室</span></div>
                    <div class="flex-item"><span>联系方式：15319436400</span></div>
                    <div class="flex-item"><span>备注：取货码18181</span><button class="processingOrder-deleteBtn"
                            data-toggle="modal" data-target="#myModal" onclick="deleteOrder(30001)">删除订单</button><button
                            class="processingOrder-modifyBtn" onclick="">修改号码</button>
                    </div>
                </div>
            </div>

            <!-- 已接单模块 -->
            <div class="myPlacedOrder-content-order receivedOrder">
                <div class="receivedOrder-content">
                    <div class="flex-item"><span>2订单时间:2019/12/8</span><span>配送截止时间:2019/12/10
                            14:40</span><span>商品规格：小件</span><span>要求：【不限】</span><span>配送费:5元</span></div>
                    <div class="flex-item"><span>取货地点：西安电子科技大学南校区，综合楼二楼韵达快递</span></div>
                    <div class="flex-item"><span>送货地点：西安电子科技大学南校区，2号宿舍楼509室</span></div>
                    <div class="flex-item"><span>联系方式：15319436400</span></div>
                    <div class="flex-item"><span>备注：取货码18181</span><button class="receivedOrder-deleteBtn flex-item"
                            data-toggle="modal" data-target="#myModal">删除订单</button><button
                            class="receivedOrder-commentBtn" onclick="">评论</button>
                        <div id="commentTestDIV">
                            <div><input id="commentTest" type="text" placeholder="进行评论" /><input type="button"
                                    value="提交评论" onclick="submitCommentTest()" /></div>
                        </div>

                    </div>
                    <div class="receivedOrder-btnDiv"><button
                            class="receivedOrder-confirmeBtn">确认收货</button><br /><button
                            class="receivedOrder-notBtn">未收到货</button></div>
                </div>
                <div class="receivedOrder-content">
                    <div class="flex-item"><span>2订单时间:2019/12/8</span><span>配送截止时间:2019/12/10
                            14:40</span><span>商品规格：小件</span><span>要求：【不限】</span><span>配送费:5元</span></div>
                    <div class="flex-item"><span>取货地点：西安电子科技大学南校区，综合楼二楼韵达快递</span></div>
                    <div class="flex-item"><span>送货地点：西安电子科技大学南校区，2号宿舍楼509室</span></div>
                    <div class="flex-item"><span>联系方式：15319436400</span></div>
                    <div class="flex-item"><span>备注：取货码18181</span><button class="receivedOrder-deleteBtn flex-item"
                            data-toggle="modal" data-target="#myModal">删除订单</button><button
                            class="receivedOrder-commentBtn" onclick="">评论</button>
                    </div>
                    <div class="receivedOrder-btnDiv"><button
                            class="receivedOrder-confirmeBtn">确认收货</button><br /><button
                            class="receivedOrder-notBtn">未收到货</button></div>
                </div>
                <div class="receivedOrder-content">
                    <div class="flex-item"><span>2订单时间:2019/12/8</span><span>配送截止时间:2019/12/10
                            14:40</span><span>商品规格：小件</span><span>要求：【不限】</span><span>配送费:5元</span></div>
                    <div class="flex-item"><span>取货地点：西安电子科技大学南校区，综合楼二楼韵达快递</span></div>
                    <div class="flex-item"><span>送货地点：西安电子科技大学南校区，2号宿舍楼509室</span></div>
                    <div class="flex-item"><span>联系方式：15319436400</span></div>
                    <div class="flex-item"><span>备注：取货码18181</span><button class="receivedOrder-deleteBtn flex-item"
                            data-toggle="modal" data-target="#myModal">删除订单</button><button
                            class="receivedOrder-commentBtn" onclick="">评论</button>
                    </div>
                    <div class="receivedOrder-btnDiv"><button
                            class="receivedOrder-confirmeBtn">确认收货</button><br /><button
                            class="receivedOrder-notBtn">未收到货</button></div>
                </div>
            </div>

            <!-- 已完成订单模块 -->
            <div class="myPlacedOrder-content-order finishedOrder">
                <div class="finishedOrder-content">
                    <div class="flex-item"><span>3订单时间:2019/12/8</span><span>配送截止时间:2019/12/10
                            14:40</span><span>商品规格：小件</span><span>要求：【不限】</span><span>配送费:5元</span></div>
                    <div class="flex-item"><span>取货地点：西安电子科技大学南校区，综合楼二楼韵达快递</span></div>
                    <div class="flex-item"><span>送货地点：西安电子科技大学南校区，2号宿舍楼509室</span></div>
                    <div class="flex-item"><span>联系方式：15319436400</span></div>
                    <div class="flex-item"><span>备注：取货码18181</span><button class="finishedOrder-deleteBtn"
                            data-toggle="modal" data-target="#myModal">删除订单</button><button
                            class="finishedOrder-commentBtn" onclick="">评论</button>
                        <button class="failedOrder-feedbackBtn" onclick="" data-toggle="modal"
                            data-target="#feedbackModal">反馈</button>
                    </div>
                </div>
                <div class="finishedOrder-content">
                    <div class="flex-item"><span>3订单时间:2019/12/8</span><span>配送截止时间:2019/12/10
                            14:40</span><span>商品规格：小件</span><span>要求：【不限】</span><span>配送费:5元</span></div>
                    <div class="flex-item"><span>取货地点：西安电子科技大学南校区，综合楼二楼韵达快递</span></div>
                    <div class="flex-item"><span>送货地点：西安电子科技大学南校区，2号宿舍楼509室</span></div>
                    <div class="flex-item"><span>联系方式：15319436400</span></div>
                    <div class="flex-item"><span>备注：取货码18181</span><button class="finishedOrder-deleteBtn"
                            data-toggle="modal" data-target="#myModal">删除订单</button><button
                            class="finishedOrder-commentBtn" onclick="">评论</button>
                        <button class="failedOrder-feedbackBtn" onclick="" data-toggle="modal"
                            data-target="#feedbackModal">反馈</button>
                    </div>
                </div>
                <div class="finishedOrder-content">
                    <div class="flex-item"><span>3订单时间:2019/12/8</span><span>配送截止时间:2019/12/10
                            14:40</span><span>商品规格：小件</span><span>要求：【不限】</span><span>配送费:5元</span></div>
                    <div class="flex-item"><span>取货地点：西安电子科技大学南校区，综合楼二楼韵达快递</span></div>
                    <div class="flex-item"><span>送货地点：西安电子科技大学南校区，2号宿舍楼509室</span></div>
                    <div class="flex-item"><span>联系方式：15319436400</span></div>
                    <div class="flex-item"><span>备注：取货码18181</span><button class="finishedOrder-deleteBtn"
                            data-toggle="modal" data-target="#myModal">删除订单</button>
                        <button class="finishedOrder-commentBtn" onclick="">评论</button>
                        <button class="failedOrder-feedbackBtn" onclick="" data-toggle="modal"
                            data-target="#feedbackModal">反馈</button>
                    </div>
                </div>
            </div>

            <!-- 已失败订单模块 -->
            <div class="myPlacedOrder-content-order failedOrder">
                <div class="failedOrder-content">
                    <div class="flex-item"><span>4订单时间:2019/12/8</span><span>配送截止时间:2019/12/10
                            14:40</span><span>商品规格：小件</span><span>要求：【不限】</span><span>配送费:5元</span></div>
                    <div class="flex-item"><span>取货地点：西安电子科技大学南校区，综合楼二楼韵达快递</span></div>
                    <div class="flex-item"><span>送货地点：西安电子科技大学南校区，2号宿舍楼509室</span></div>
                    <div class="flex-item"><span>联系方式：15319436400</span></div>
                    <div class="flex-item"><span>备注：取货码18181</span><button class="failedOrder-deleteBtn">删除订单</button>
                        <button class="failedOrder-feedbackBtn" onclick="" data-toggle="modal"
                            data-target="#feedbackModal">反馈</button><button class="failedOrder-commentBtn"
                            onclick="">评论</button>
                    </div>
                </div>
                <div class="failedOrder-content">
                    <div class="flex-item"><span>4订单时间:2019/12/8</span><span>配送截止时间:2019/12/10
                            14:40</span><span>商品规格：小件</span><span>要求：【不限】</span><span>配送费:5元</span></div>
                    <div class="flex-item"><span>取货地点：西安电子科技大学南校区，综合楼二楼韵达快递</span></div>
                    <div class="flex-item"><span>送货地点：西安电子科技大学南校区，2号宿舍楼509室</span></div>
                    <div class="flex-item"><span>联系方式：15319436400</span></div>
                    <div class="flex-item"><span>备注：取货码18181</span><button class="failedOrder-deleteBtn">删除订单</button>
                        <button class="failedOrder-feedbackBtn" onclick="" data-toggle="modal"
                            data-target="#feedbackModal">反馈</button><button class="failedOrder-commentBtn"
                            onclick="">评论</button>
                    </div>
                </div>
                <div class="failedOrder-content">
                    <div class="flex-item"><span>4订单时间:2019/12/8</span><span>配送截止时间:2019/12/10
                            14:40</span><span>商品规格：小件</span><span>要求：【不限】</span><span>配送费:5元</span></div>
                    <div class="flex-item"><span>取货地点：西安电子科技大学南校区，综合楼二楼韵达快递</span></div>
                    <div class="flex-item"><span>送货地点：西安电子科技大学南校区，2号宿舍楼509室</span></div>
                    <div class="flex-item"><span>联系方式：15319436400</span></div>
                    <div class="flex-item"><span>备注：取货码18181</span><button class="failedOrder-deleteBtn"
                            data-toggle="modal" data-target="#myModal">删除订单</button>
                        <button class="failedOrder-feedbackBtn" onclick="" data-toggle="modal"
                            data-target="#feedbackModal">反馈</button><button class="failedOrder-commentBtn"
                            onclick="">评论</button>
                    </div>
                </div>
            </div>

            <!-- 确认删除模态框 -->
            <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
                aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                            <h4 class="modal-title" id="myModalLabel">注意！</h4>
                        </div>
                        <div class="modal-body">确认删除订单？</div>
                        <div class="modal-footer">
                            <input type="hidden" id="orderInfoID" />
                            <button type="button" data-dismiss="modal" class="modal-btn-delete"
                                onclick="confirmDeleteOrder(true)">删除</button>
                            <button type="button" class="modal-btn-cancel" data-dismiss="modal">取消</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 投诉模态框 -->
            <div class="modal fade" id="feedbackModal" tabindex="-1" role="dialog" aria-labelledby="feedbackModalLabel"
                aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                            <h4 class="modal-title" id="feedbackModalLabel">反馈</h4>
                        </div>
                        <div class="modal-body">请输入您的反馈：
                            <input name="modal-feedbackType" type="radio" value="0" checked>平台问题
                            <input name="modal-feedbackType" type="radio" value="1">投诉接单人
                            <br />
                            <br />
                            <input id="modal-feedbackInfo" type="text" /></div>
                        <div class="modal-footer">
                            <button type="button" data-dismiss="modal" class="modal-btn-submit"
                                onclick="submitFeedback()">提交</button>
                            <button type="button" data-dismiss="modal" class="modal-btn-cancel">取消</button>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <script language="javascript" type="text/javascript">
            $(document).ready(function () {
                var processing = document.getElementById("processing");
                changeContent(processing, processing.id);
            })

            //改变选中模块的css样式
            function selectedStyle(obj) {
                $(".myPlacedOrder-nav-orderStatus").css({ "background-color": "white", "color": "black" });
                obj.style.setProperty("background-color", "rgb(99, 120, 148)", "important");
                obj.style.setProperty("color", "white", "important");
            }

            //使选中的模块显示，其他模块隐藏
            function selectedModule(module) {
                $(".myPlacedOrder-content-order").css({ "display": "none" });
                document.getElementsByClassName(module)[0].style.setProperty("display", "block", "important");
                console.log(module);

            }

            //切换订单模块
            function changeContent(obj) {
                selectedStyle(obj);
                let module = obj.id + "Order";
                selectedModule(module);
            }

            //删除订单
            function deleteOrder(OID) {
                $("#orderInfoID").val(OID);
            }

            function confirmDeleteOrder() {
                let orderInfoID = $("#orderInfoID").val();
                console.log(orderInfoID);
                document.getElementById(orderInfoID).remove();
                // var a=$("#orderInfoID").remove();
                // console.log(a);
            }


            //清空反馈框
            $("#feedbackModal").on("hidden.bs.modal", () => { $("#modal-feedbackInfo").val(""); });
            //提交反馈
            function submitFeedback() {
                const feedbackTypeID = $("input[name='modal-feedbackType']:checked").val();
                const feedbackUserID = user.userID;
                const telephone = user.telephone;
                const content = $("#modal-feedbackInfo").val();
                const feedbackOrderID = "10001";
                const data = {
                    "feedbackTypeID": "feedbackTypeID",
                    "feedbackUserID": "feedbackUserID",
                    "telephone": "telephone",
                    "content": "content",
                    "feedbackOrderID": "feedbackOrderID"
                };
                if (feedbackTypeID == 1) {
                    const respondentID = "123456789";
                    data["respondentID"] = "respondentID";
                    // console.log("respondentID:"+respondentID);

                }
                // console.log("feedbackTypeID:"+feedbackTypeID);
                // console.log("feedbackUserID:"+feedbackUserID);
                // console.log("telephone:"+telephone);
                // console.log("content:"+content);
                // console.log("feedbackOrderID:"+feedbackOrderID);


                $.ajax({
                    url: "/feedback/addFeedback",
                    type: "POST",
                    async: true,
                    contentType: "application/json",
                    data: JSON.stringify(data),
                    dataType: "json",
                    success: function (result) {
                        if (result.isSuccess) {
                            alert("反馈成功");
                        } else {
                            alert("反馈失败，请刷新重试");
                        }
                    }
                })
            }

            function submitCommentTest() {
                let bodyContent = "<div></div>";
                const userID = user.userID;
                const content = $("#commentTest").val();
                bodyContent += content;
                $("#commentTestDIV").append(bodyContent);

                const data = { "userID": userID, "content": content };
                $.ajax({
                    url: "/onlineChat/insertComment",
                    type: "POST",
                    async: false,
                    contentType: "application/json",
                    data: JSON.stringify(data),
                    dataType: "json",
                    success: function (result) {
                        if (result.isSuccess) {
                            if (result.success) {
                                alert("评论成功");
                            } else {
                                alert("评论失败");
                            }
                        } else {
                            alert("请求失败");
                        }
                    }
                });
                $.ajax({
                    url: "/onlineChat/commentDetails",
                    type: "POST",
                    async: false,
                    contentType: "application/json",
                    data: JSON.stringify(data1),
                    dataType: "json",
                    success: function (result) {
                        if (result.isSuccess) {
                            if (result.success) {
                                alert("评论获取成功");
                                bodyContent += result.data.createContent;
                                $("#commentTestDIV").append(bodyContent);
                            }else{
                                alert("评论获取失败");
                            }
                        } else {
                            alert("请求失败");
                        }
                    }
                })

            }
        </script>
</body>


</html>